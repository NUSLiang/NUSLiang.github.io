<ul class="navbar-nav ml-auto flex-nowrap">
  <!-- Home link -->
  <li class="nav-item {% if page.permalink == '/' %}active{% endif %}">
    <a class="nav-link" href="{{ '/' | relative_url }}">
      Home
      {% if page.permalink == '/' %}
        <span class="sr-only">(current)</span>
      {% endif %}
    </a>
  </li>

  <!-- Other pages -->
  {% assign sorted_pages = site.pages | sort: 'nav_order' %}
  {% for p in sorted_pages %}
    {% if p.nav and p.autogen == null and p.permalink != '/' %}
      {% if p.dropdown %}
        <!-- Dropdown logic -->
        <li class="nav-item dropdown {% if page.title == p.title %}active{% endif %}">
          <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
            {{- p.title }}
          </a>
          <div class="dropdown-menu dropdown-menu-right" aria-labelledby="navbarDropdown">
            {% for child in p.children %}
              {% if child.title == 'divider' %}
                <div class="dropdown-divider"></div>
              {% else %}
                <a class="dropdown-item {% if page.title == child.title %}active{% endif %}" href="{{ child.permalink | relative_url }}">
                  {{- child.title -}}
                </a>
              {% endif %}
            {% endfor %}
          </div>
        </li>
      {% else %}
        <!-- Regular link -->
        <li class="nav-item {% if page.url contains p.url %}active{% endif %}">
          <a class="nav-link" href="{{ p.url | relative_url }}">
            {{- p.title }}
            {% if page.url contains p.url %}
              <span class="sr-only">(current)</span>
            {% endif %}
          </a>
        </li>
      {% endif %}
    {% endif %}
  {% endfor %}

  {% if site.search_enabled %}
    <!-- Search -->
    <li class="nav-item">
      <button id="search-toggle" title="Search" onclick="openSearchModal()">
        <span class="nav-link">ctrl k <i class="ti ti-search"></i></span>
      </button>
    </li>
  {% endif %}

  {% if site.enable_darkmode %}
    <!-- Theme toggle -->
    <li class="toggle-container">
      <button id="light-toggle" title="Change theme">
        <i class="ti ti-sun-moon" id="light-toggle-system"></i>
        <i class="ti ti-moon-filled" id="light-toggle-dark"></i>
        <i class="ti ti-sun-filled" id="light-toggle-light"></i>
      </button>
    </li>
  {% endif %}
</ul>
